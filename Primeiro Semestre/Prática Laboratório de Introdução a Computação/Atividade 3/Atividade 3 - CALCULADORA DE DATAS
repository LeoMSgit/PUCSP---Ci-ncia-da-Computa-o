#include <stdio.h>
int a; //VARIAVEL ANO
int m; //VARIAVEL MES
int d; //VARIAVEL DIA
int fAnoBissexto(int a); //VERIFICAÇÃO ANO BISSEXTO
int fDataValida(int a, int m, int d); // VERIFICAÇÃO DE DATA VÁLIDA
int Menu = 0; //VARIAVEL MENU
int fMenu(); //MENU
int max_dias;

// FUNÇÃO MENU
int fMenu() {
    printf("\nBEM VINDO A CALCULADORA DE DATAS\n");
    printf("1 - Iniciar; 2 - Sair\n");
    scanf("%d", &Menu);

    return Menu;
}

// FUNÇÃO VERIFICAÇÃO ANO BISSEXTO
int fAnoBissexto(int a){
    if ((a % 4 == 0 && a % 100 != 0) || (a % 400 == 0)) {
        return 1; // BISSEXTO
    } else {
        return 0; // NÃO BISSEXTO
    }
}

// FUNÇÃO VERIFICAÇÃO DE DATA VÁLIDA
//   Retorna 0 se a data for válida
//   Retorna 1 se o dia for inválido
//   Retorna 2 se o mês for inválido
//   Retorna 3 se o ano for inválido
int fDataValida(int a, int m, int d) {
    // VERIFICAÇÃO ANO VALIDO
    if (a < 1) {
        return 3;
    }

    // VERIFICAÇÃO MES VALIDO
    if (m < 1 || m > 12) {
        return 2;
    }

    // VERIFICAÇÃO DIAS MAXIMOS NO MES
    switch (m) {
        case 2:
        // VERIFICAÇÃO BISSEXTO
        if ((a % 4 == 0 && a % 100 != 0) || (a % 400 == 0)) {
            max_dias = 29; // BISSEXTO
        } else {
            max_dias = 28; // NÃO BISSEXTO
        }
        break;
    case 4:
    case 6:
    case 9:
    case 11:
        max_dias = 30;
        break;
    default:
        max_dias = 31;
        break;
    }

    // VERIFICAÇÃO DIA VALIDOS
    if (d < 1 || d > max_dias) {
        return 1;
    }

    // VERIFICAÇÃO FINAL
    return 0; // DATA FINAL É VALIDA
}
    
    
// CORPO DO PROGRAMA    
int main (){
    do {
        // MENU
        fMenu();

        if (Menu == 1) {
            do {
                // INPUT ANO
                printf("Digite o ANO: ");
                scanf("%d", &a);
                if (a < 1) {
                    printf("ERRO: Ano invalido\n");
                } else if (fAnoBissexto(a) == 1){
                	printf("O ano %d e Bissexto\n", a);
                } else 
                	printf("O ano %d nao e Bissexto\n", a);
            } while (a < 1);
            do {
                // INPUT MES
                printf("Digite o MES: ");
                scanf("%d", &m);
                if (m < 1 || m > 12) {
                    printf("ERRO: Mes invalido\n");
                }
            } while (m < 1 || m > 12);

            // MAXIMO DE DIAS NO ANO
            fDataValida(a, m, d);

            do {
                // INPUT DIA
                printf("Digite o DIA: ");
                scanf("%d", &d);
                if (d < 1 || d > max_dias) {
                    printf("ERRO: Dia invalido para este mes\n");
                }
            } while (d < 1 || d > max_dias);

            // DATA INSERIDA
            printf("Data Inserida: %02d/%02d/%d\n", d, m, a);
        } else if (Menu != 2) {
            printf("ERRO: Opcao invalida. Escolha 1 para Iniciar ou 2 para Sair.\n");
        }
    } while (Menu != 2 && Menu !=0);

    printf("SAINDO...\n");
}
